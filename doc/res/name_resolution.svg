<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" width="901px" height="1311px" viewBox="-0.5 -0.5 901 1311" content="&lt;mxfile host=&quot;Electron&quot; modified=&quot;2020-06-23T17:53:42.564Z&quot; agent=&quot;5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) draw.io/13.0.3 Chrome/80.0.3987.163 Electron/8.2.1 Safari/537.36&quot; etag=&quot;B3vI4Vjl-gHfJTg6nwlv&quot; version=&quot;13.0.3&quot; type=&quot;device&quot;&gt;&lt;diagram id=&quot;C5RBs43oDa-KdzZeNtuy&quot; name=&quot;Page-1&quot;&gt;5VzZdps4GH6anKYX9mExiy9bZ2lmOjPpMk0zNz6ykW0ajFwhx/E8/WjFgIhNGjAk03PqgJAE6N++fxEn9mj5cInBavEHCmB0YhnBw4l9dmJZlmFa9A9r2YoW13dEwxyHgWgydw1fwn+hbDRk6zoMYJLrSBCKSLjKN05RHMMpybUBjNEm322GovxdV2AOtYYvUxDprTdhQBai1be8XfsHGM4X6s6mOxRXlkB1lm+SLECANpkm+/zEHmGEiDhaPoxgxBZPrcvN1fYm+njnXv72KfkJ/n7/+9c/v/XEZBdPGZK+AoYx+eWpL36gydXtHfnLHfy1GY6+zcDNTc+Wr0a2ar1gQJdPniJMFmiOYhCd71rfY7SOA8hmNejZrs9HhFa00aSNPyAhW8kLYE0QbVqQZSSvwoeQfGfD+448u81cOXuQM/OTrTqJCd5mBrHT2+y13TB+psZVXDq5xAla4yncs16SFQjAc0j29JNCwxYzw4aSMJcQLSF9SNoBwwiQ8D7Pq0Cy/DzttyMrPZCUfQKV5VPfg2gt73QJybsgwFfxDJ2+ZdIHooiStMgMO1Iz6mwWIYFfVoCv0IaqizxZn7bU9xAT+LB3cVIdJJ9/qzSLPN/s5Nn0ZdsiI8uO0dB6Wpa2oG3IUc28bVXk7UGneNuyNVr8WUqMj2BCTVtuAUEUzmN6PKULCDFtYEwZUll4Jy8swyAQtIJJ+C+Y8PkYtVYojAl/Fef9iXNWSoz9rFNk/9QCyrvkjEyZWPSMvm05OclQpK688nLya/Y2mS5oNksoCxRJkz7DM6jl/Y8ExXK7JSm+Jim3XZYUry5JMfrG0Bh2XjQ06nwA9Dk5EJ0u2OiY2TeU0NW0LqbrhKDlrsGYhRHrDGJqxd2ILuz7CaZHcyJogqJ7OI4Qs/PbcTgb80nHanDIfhCl44UOARZoOVkn7Zl/084rOXOom3/bLDH/fmPm39RI9Qq02qCiVnO6pdScl6XUHmP/XzH/HpWF52m13VyGnRMyu28WZmlO8dl+G9KjnFB1zJ3J1CEtd0Jbkji7WyLn6O5klxG3Yq9aRM50Ha/rQGKgkWeF0cN2HMRZUy+hgjGNQrZ+Gmbg/X6uId6G8ZzhC4T5GPpzdX0/UOMveDNtcVlLEFCyJfpkcjD9/3V0nR/699n1jhJhVzGIYfXzKCRFHFkU4jnHRCG6GL4CFOJU1Ilet1SiRopLJtvqNaj0YA7WyQJKyB6DZQrXDbyOYKJzfY40bXG+lw++DSyd761BCfp2m+J7Uw/4vAK+dyvyvVl79K0cElrDPN39YYGe4knlqAaMmE7lLuP6lCnrABmWrzCLXHzreZBDzWzlRzSIQAZtSGQHEH1VKbaGnTJfA91+dRnRK/aqx4ke2FYe2dUjbE7ft8vmbV76XI2YXxZoHTGgsU4Y6JiBO8hBe8LBdhGsn6qAI4i3Epwwl4GBdb0znXHM5huHq/FmAeOxAjfjGBERZWR5xVLvgoP9tzruaRvt+14B7Hu2DnoGxjHB/rBNhfoC8/ReRUXsd0oPm7pL12XQM6xLDVPIYw3d5+ndNAVq9T3/aEDHLCVPB4HOC5PL2jOnfOg7jME200Fy/qNGPHV2JXM5EihdVOzvmcbe/kUnq9CfHognrpdnrZcF9urMmLiGm1vwztdLeBqtvqqQEodQZ1efz0dfJTwrgqxEwT4KxVLwB3YAMFx1M9jqF6ROIa1syMk6ZsJX5cJeV8jJb0sXP4sWehHLZ1HdQBtlfcMel2ZP+QROSIkv0oUYbFpLrUqwS9wR0z1qDFbXS60AoW6AGrMkkfsP+IS3a+/6+4fg8+393Q9w/u2HqsM9dux2WFSMDcduTT0DeQljiAEpRB80ORXpECqamHUR2ZIlWK14CrLYmf4FSyaCvD2dlv70TrJJlhFfUa4jAnHj03AmwhtvxVWVppHzydm7qAqKttF3S9IxR7WNA7cVyX+5oQmzqt0d1B6cqKYuzDS3fSx9UWbTyRrHWW2xRx7b3JtgF9YuFb6sbS4TyMZss93Knp6ahcRqL5PyS5ECzyiHaI95/u4jkK5Rz9/SMwMl2FnWKhSt7YHC4y4aS7cQjrHKNg4dFTcPWtn+8IKNpRLvw8ayGT1wUHBN48iFEWpFyoxlDuV202A6TsE3KanmP7K9fDG5tZply65aa9cRG1sUPf9AdP1A/2ZsrK2XUrz6+JRTAMF2GQY+rp3VPYp+v/8RsKQFXQGMHsJZyPUkPZ5jwFZaZhPYYlNhVdGHjP8xSgME8SRZieUWG7MS0T2W0Qo+8QRM79RUmYLPUxAhXk+9CcmiqLITEY7IRCdkgah4ljRMUeCe3HOsMLwP0TrhUC6A0zAo2ddNCUvyvJEQjO7gCEUI05YYxUzLUWgXFZqqZ4DKmDHPrk3xo7Zh3Fb7ZA7tGB82VmGlW+0nMyQjAP2dPcI1WU6RBcUG4HE0ypKRmJzX/YsuPFDG5xVMonHZ/4plHEuDdRVZxqtBh5UGi9uJqB/dVSiAil/DN/ui7Qej8sdKZ5XevFNlzpVz7HkqPc6++3LxtoKVnci+l76D04YIdkUsBm2KhR6parFGpU6xcPaKBZOKwnb3esqRTdPv2/l65F4TBcn7OO5QEQurRTFOwz7sP/oFA4Zh2IfDmFnm950wxLJOmLw9v5K4hM7VpK5yum7o6Z5RY+m6Ulq0utf66cGO5tRgQ7k0f9h3M/+GXh5WpsSuP1r4+FvmRO8ijITTkc3DGxP27mS7kulyMJ0iHIiNv9xHyDscb2Tnkgz+KezP+8qHLbopTG0SwL9jgmLuoBY3Do9OUk8aaylAsetYdeVTsFvdsKsBit8wOmwAJ4dwZdTeZvEO0wVC+f0P+QnZvWdhLF87ZOPgcgIwBkkil2IB+D343EDcEMNVxNSKHCHdelB8e/01J3AKREmeeNjPF6OebfjDnpBN5RVue+LeCxFPwPDnOsQwSYclIq7AA0jyKTkZhaOYrYqQe02zT1VLQKkBtTkoemO+rjdto0RvmsXUdW2Ks53MTUddq6pfrhCZ/dq1bGFPsplm4Q9o1adGnHtm4dNDluFn5ztcSlEY8OyY8z5qPFfJ54ObPOA8JmuKc6Mx1VPJOFztPvtQoa/bqprjn7xg4yC+5yuxNyHWoq7rmVroyS+pdy77wFX6IcwnKDt6uvtirWDA3Xd/7fP/AA==&lt;/diagram&gt;&lt;/mxfile&gt;"><defs/><g><path d="M 410 50 L 410 83.63" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 410 88.88 L 406.5 81.88 L 410 83.63 L 413.5 81.88 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><rect x="320" y="0" width="180" height="50" rx="7.5" ry="7.5" fill="#ffffff" stroke="#000000" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 178px; height: 1px; padding-top: 25px; margin-left: 321px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">GetAddrInfo() called</div></div></div></foreignObject><text x="410" y="29" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">GetAddrInfo() called</text></switch></g><path d="M 410 170 L 410 203.63" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 410 208.88 L 406.5 201.88 L 410 203.63 L 413.5 201.88 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 184px; margin-left: 409px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 11px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; background-color: #ffffff; white-space: nowrap; ">N</div></div></div></foreignObject><text x="409" y="187" fill="#000000" font-family="Helvetica" font-size="11px" text-anchor="middle">N</text></switch></g><path d="M 565 130 L 733.63 130" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 738.88 130 L 731.88 133.5 L 733.63 130 L 731.88 126.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 130px; margin-left: 661px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 11px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; background-color: #ffffff; white-space: nowrap; ">Y</div></div></div></foreignObject><text x="661" y="134" fill="#000000" font-family="Helvetica" font-size="11px" text-anchor="middle">Y</text></switch></g><path d="M 410 90 L 565 130 L 410 170 L 255 130 Z" fill="#ffffff" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 308px; height: 1px; padding-top: 130px; margin-left: 256px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">Have match in hosts/custom hosts file and<br />resolve_locally_if_match_hosts is on?</div></div></div></foreignObject><text x="410" y="134" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">Have match in hosts/custom hosts file and...</text></switch></g><path d="M 410 290 L 410 310 L 410 300 L 410 313.63" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 410 318.88 L 406.5 311.88 L 410 313.63 L 413.5 311.88 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 300px; margin-left: 410px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 11px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; background-color: #ffffff; white-space: nowrap; ">Y</div></div></div></foreignObject><text x="410" y="303" fill="#000000" font-family="Helvetica" font-size="11px" text-anchor="middle">Y</text></switch></g><path d="M 597.5 250 L 643.63 250" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 648.88 250 L 641.88 253.5 L 643.63 250 L 641.88 246.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 250px; margin-left: 620px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 11px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; background-color: #ffffff; white-space: nowrap; ">N</div></div></div></foreignObject><text x="620" y="254" fill="#000000" font-family="Helvetica" font-size="11px" text-anchor="middle">N</text></switch></g><path d="M 410 210 L 597.5 250 L 410 290 L 222.5 250 Z" fill="#ffffff" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 373px; height: 1px; padding-top: 250px; margin-left: 224px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">proxy_dns is on and client<br />is querying for an IPv4 and/or IPv6 address<br />for a TCP and/or UDP connection?</div></div></div></foreignObject><text x="410" y="254" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">proxy_dns is on and client...</text></switch></g><path d="M 410 380 L 410 400 L 410 385 L 410 398.63" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 410 403.88 L 406.5 396.88 L 410 398.63 L 413.5 396.88 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><rect x="290" y="320" width="240" height="60" fill="#ffffff" stroke="#000000" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 238px; height: 1px; padding-top: 350px; margin-left: 291px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">Get target from the hostname and rules</div></div></div></foreignObject><text x="410" y="354" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">Get target from the hostname and rules</text></switch></g><path d="M 410 710 L 410 753.63" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 410 758.88 L 406.5 751.88 L 410 753.63 L 413.5 751.88 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 728px; margin-left: 410px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 11px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; background-color: #ffffff; white-space: nowrap; ">Y</div></div></div></foreignObject><text x="410" y="731" fill="#000000" font-family="Helvetica" font-size="11px" text-anchor="middle">Y</text></switch></g><path d="M 612.5 670 L 730 670 L 730 883.63" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 730 888.88 L 726.5 881.88 L 730 883.63 L 733.5 881.88 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 670px; margin-left: 650px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 11px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; background-color: #ffffff; white-space: nowrap; ">N</div></div></div></foreignObject><text x="650" y="674" fill="#000000" font-family="Helvetica" font-size="11px" text-anchor="middle">N</text></switch></g><path d="M 410 630 L 612.5 670 L 410 710 L 207.5 670 Z" fill="#ffffff" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 403px; height: 1px; padding-top: 670px; margin-left: 209px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">Should use fake IPs?<br />(match any rule or <br />use_fake_ip_when_hostname_not_matched<br />is on?)</div></div></div></foreignObject><text x="410" y="674" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">Should use fake IPs?...</text></switch></g><path d="M 410 485 L 410 523.63" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 410 528.88 L 406.5 521.88 L 410 523.63 L 413.5 521.88 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 500px; margin-left: 410px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 11px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; background-color: #ffffff; white-space: nowrap; ">Y</div></div></div></foreignObject><text x="410" y="503" fill="#000000" font-family="Helvetica" font-size="11px" text-anchor="middle">Y</text></switch></g><path d="M 520 445 L 540 445 L 540 610 L 410 610 L 410 623.63" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 410 628.88 L 406.5 621.88 L 410 623.63 L 413.5 621.88 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 491px; margin-left: 541px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 11px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; background-color: #ffffff; white-space: nowrap; ">N</div></div></div></foreignObject><text x="541" y="495" fill="#000000" font-family="Helvetica" font-size="11px" text-anchor="middle">N</text></switch></g><path d="M 410 405 L 520 445 L 410 485 L 300 445 Z" fill="#ffffff" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 218px; height: 1px; padding-top: 445px; margin-left: 301px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">Target is DIRECT or<br />should not use a fake ip?</div></div></div></foreignObject><text x="410" y="449" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">Target is DIRECT or...</text></switch></g><path d="M 410 590 L 410 623.63" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 410 628.88 L 406.5 621.88 L 410 623.63 L 413.5 621.88 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><rect x="330" y="530" width="160" height="60" fill="#ffffff" stroke="#000000" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 158px; height: 1px; padding-top: 560px; margin-left: 331px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">Resolve locally<br />(match hosts/custom hosts first)</div></div></div></foreignObject><text x="410" y="564" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">Resolve locally...</text></switch></g><path d="M 410 840 L 410 860 L 410 850 L 410 863.63" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 410 868.88 L 406.5 861.88 L 410 863.63 L 413.5 861.88 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><rect x="300" y="760" width="220" height="80" fill="#ffffff" stroke="#000000" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 218px; height: 1px; padding-top: 800px; margin-left: 301px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">Generate fake IPs<br />and store the mapping<br />&lt;fake IP - hostname, resolved IPs(if any), target&gt;</div></div></div></foreignObject><text x="410" y="804" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">Generate fake IPs...</text></switch></g><path d="M 410 1180 L 410 1212.63" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 410 1217.88 L 406.5 1210.88 L 410 1212.63 L 413.5 1210.88 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><rect x="350" y="1120" width="120" height="60" rx="9" ry="9" fill="#ffffff" stroke="#000000" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 118px; height: 1px; padding-top: 1150px; margin-left: 351px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">Return fake IP</div></div></div></foreignObject><text x="410" y="1154" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">Return fake IP</text></switch></g><path d="M 820 160 L 820 530 L 730 530 L 730 883.63" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 730 888.88 L 726.5 881.88 L 730 883.63 L 733.5 881.88 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><rect x="740" y="100" width="160" height="60" fill="#ffffff" stroke="#000000" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 158px; height: 1px; padding-top: 130px; margin-left: 741px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">Resolve locally from<br />hosts/custom hosts file</div></div></div></foreignObject><text x="820" y="134" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">Resolve locally from...</text></switch></g><path d="M 730 950 L 730 992.63" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 730 997.88 L 726.5 990.88 L 730 992.63 L 733.5 990.88 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><rect x="670" y="890" width="120" height="60" rx="9" ry="9" fill="#ffffff" stroke="#000000" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 118px; height: 1px; padding-top: 920px; margin-left: 671px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">Return resolved IP</div></div></div></foreignObject><text x="730" y="924" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">Return resolved IP</text></switch></g><path d="M 730 280 L 730 710 L 730 883.63" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 730 888.88 L 726.5 881.88 L 730 883.63 L 733.5 881.88 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><rect x="650" y="220" width="160" height="60" fill="#ffffff" stroke="#000000" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 158px; height: 1px; padding-top: 250px; margin-left: 651px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">Resolve locally<br />(match hosts/custom hosts first)</div></div></div></foreignObject><text x="730" y="254" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">Resolve locally...</text></switch></g><rect x="320" y="1219" width="180" height="91" fill="none" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 178px; height: 1px; padding-top: 1265px; margin-left: 321px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">...Later proxified program connects to the fake IP, which is then mapped back to hostname (along with resolved IPs, if any) and the target<br />which is previously decided</div></div></div></foreignObject><text x="410" y="1268" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">...Later proxified program con...</text></switch></g><rect x="640" y="999" width="180" height="70" fill="none" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 178px; height: 1px; padding-top: 1034px; margin-left: 641px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">...Later proxified program connects to one of resolved IPs, and the rules are applied on the IP to decide the target</div></div></div></foreignObject><text x="730" y="1038" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">...Later proxified program con...</text></switch></g><path d="M 410 950 L 410 973.63" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 410 978.88 L 406.5 971.88 L 410 973.63 L 413.5 971.88 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 960px; margin-left: 410px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 11px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; background-color: #ffffff; white-space: nowrap; ">Y</div></div></div></foreignObject><text x="410" y="964" fill="#000000" font-family="Helvetica" font-size="11px" text-anchor="middle">Y</text></switch></g><path d="M 300 910 L 105 910 L 105 978.63" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 105 983.88 L 101.5 976.88 L 105 978.63 L 108.5 976.88 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 910px; margin-left: 240px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 11px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; background-color: #ffffff; white-space: nowrap; ">N</div></div></div></foreignObject><text x="240" y="914" fill="#000000" font-family="Helvetica" font-size="11px" text-anchor="middle">N</text></switch></g><path d="M 410 870 L 520 910 L 410 950 L 300 910 Z" fill="#ffffff" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 218px; height: 1px; padding-top: 910px; margin-left: 301px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">Target is DIRECT? (i.e.<br />resolved ips will be used?)</div></div></div></foreignObject><text x="410" y="914" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">Target is DIRECT? (i.e....</text></switch></g><path d="M 410 1090 L 409.74 1113.63" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 409.68 1118.88 L 406.26 1111.84 L 409.74 1113.63 L 413.26 1111.92 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><rect x="260" y="980" width="300" height="110" fill="#ffffff" stroke="#000000" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 298px; height: 1px; padding-top: 1035px; margin-left: 261px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">Filter fake IPs by type, according to resolved IPs' types<br />(e.g. if resolved IPs contain only IPv6 address, then return fake IPv4 address only. We don't want the client to choose fake IPv4 address, finding it embarrassing that we can't replace it with a resolved IPv6 address, because the RFC-3089-style proxify-ing hack requires the same matching type of fake IP and resolved IP)</div></div></div></foreignObject><text x="410" y="1039" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">Filter fake IPs by type, according to resolved IPs...</text></switch></g><path d="M 105 1085 L 105 1108 L 410 1108 L 410 1113.63" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 410 1118.88 L 406.5 1111.88 L 410 1113.63 L 413.5 1111.88 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><rect x="0" y="985" width="210" height="100" fill="#ffffff" stroke="#000000" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 208px; height: 1px; padding-top: 1035px; margin-left: 1px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">Filter fake IPs by type, according to first_tunnel_uses_ipv4 and first_tunnel_uses_ipv6, because the RFC-3089-style proxify-ing hack requires the same matching type of fake IP and proxy server IP</div></div></div></foreignObject><text x="105" y="1039" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">Filter fake IPs by type, according...</text></switch></g></g><switch><g requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"/><a transform="translate(0,-5)" xlink:href="https://desk.draw.io/support/solutions/articles/16000042487" target="_blank"><text text-anchor="middle" font-size="10px" x="50%" y="100%">Viewer does not support full SVG 1.1</text></a></switch></svg>